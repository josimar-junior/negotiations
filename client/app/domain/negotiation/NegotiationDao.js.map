{"version":3,"sources":["../../../app-src/domain/negotiation/NegotiationDao.js"],"names":["Negotiation","NegotiationDao","constructor","connection","_connection","_store","save","negotiation","Promise","resolve","reject","request","transaction","objectStore","add","onsuccess","e","onerror","console","log","target","error","listAll","negotiatons","cursor","openCursor","current","result","value","_date","_quantity","_value","push","continue","clear"],"mappings":";;;;;;AAASA,uB,kBAAAA,W;;;AAEF,kBAAMC,cAAN,CAAqB;;AAExBC,4BAAYC,UAAZ,EAAwB;AACpB,yBAAKC,WAAL,GAAmBD,UAAnB;AACA,yBAAKE,MAAL,GAAc,cAAd;AACH;;AAEDC,qBAAKC,WAAL,EAAkB;AACd,2BAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpC,8BAAMC,UAAU,KAAKP,WAAL,CACXQ,WADW,CACC,CAAC,KAAKP,MAAN,CADD,EACgB,WADhB,EAEXQ,WAFW,CAEC,KAAKR,MAFN,EAGXS,GAHW,CAGPP,WAHO,CAAhB;;AAKAI,gCAAQI,SAAR,GAAoBC,KAAKP,SAAzB;AACAE,gCAAQM,OAAR,GAAkBD,KAAK;AACnBE,oCAAQC,GAAR,CAAYH,EAAEI,MAAF,CAASC,KAArB;AACAX,mCAAO,0BAAP;AACH,yBAHD;AAIH,qBAXM,CAAP;AAYH;;AAEDY,0BAAU;AACN,2BAAO,IAAId,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpC,8BAAMa,cAAc,EAApB;;AAEA,8BAAMC,SAAS,KAAKpB,WAAL,CACVQ,WADU,CACE,CAAC,KAAKP,MAAN,CADF,EACiB,WADjB,EAEVQ,WAFU,CAEE,KAAKR,MAFP,EAGVoB,UAHU,EAAf;;AAKAD,+BAAOT,SAAP,GAAmBC,KAAK;AACpB,kCAAMU,UAAUV,EAAEI,MAAF,CAASO,MAAzB;AACA,gCAAID,OAAJ,EAAa;AACT,sCAAMnB,cAAc,IAAIP,WAAJ,CAAgB0B,QAAQE,KAAR,CAAcC,KAA9B,EAAqCH,QAAQE,KAAR,CAAcE,SAAnD,EAA8DJ,QAAQE,KAAR,CAAcG,MAA5E,CAApB;AACAR,4CAAYS,IAAZ,CAAiBzB,WAAjB;AACAmB,wCAAQO,QAAR;AACH,6BAJD,MAIO;AACHxB,wCAAQc,WAAR;AACH;AACJ,yBATD;;AAWAC,+BAAOP,OAAP,GAAiBD,KAAK;AAClBE,oCAAQC,GAAR,CAAYH,EAAEI,MAAF,CAASC,KAArB;AACAX,mCAAO,4BAAP;AACH,yBAHD;AAIH,qBAvBM,CAAP;AAwBH;;AAEDwB,wBAAQ;AACJ,2BAAO,IAAI1B,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpC,8BAAMC,UAAU,KAAKP,WAAL,CACXQ,WADW,CACC,CAAC,KAAKP,MAAN,CADD,EACgB,WADhB,EAEXQ,WAFW,CAEC,KAAKR,MAFN,EAGX6B,KAHW,EAAhB;;AAKAvB,gCAAQI,SAAR,GAAoBC,KAAKP,SAAzB;AACAE,gCAAQM,OAAR,GAAkBD,KAAK;AACnBE,oCAAQC,GAAR,CAAYH,EAAEI,MAAF,CAASC,KAArB;AACAX,mCAAO,iCAAP;AACH,yBAHD;AAIH,qBAXM,CAAP;AAYH;AA9DuB","file":"NegotiationDao.js","sourcesContent":["import { Negotiation } from './Negotiation.js';\n\nexport class NegotiationDao {\n\n    constructor(connection) {\n        this._connection = connection;\n        this._store = 'negotiations';\n    }\n\n    save(negotiation) {\n        return new Promise((resolve, reject) => {\n            const request = this._connection\n                .transaction([this._store], 'readwrite')\n                .objectStore(this._store)\n                .add(negotiation);\n\n            request.onsuccess = e => resolve();\n            request.onerror = e => {\n                console.log(e.target.error);\n                reject('Error saving negotiation');\n            }\n        });\n    }\n\n    listAll() {\n        return new Promise((resolve, reject) => {\n            const negotiatons = [];\n\n            const cursor = this._connection\n                .transaction([this._store], 'readwrite')\n                .objectStore(this._store)\n                .openCursor();\n\n            cursor.onsuccess = e => {\n                const current = e.target.result;\n                if (current) {\n                    const negotiation = new Negotiation(current.value._date, current.value._quantity, current.value._value);\n                    negotiatons.push(negotiation);\n                    current.continue();\n                } else {\n                    resolve(negotiatons);\n                }\n            }\n\n            cursor.onerror = e => {\n                console.log(e.target.error);\n                reject('Error listing negotiations');\n            }\n        });\n    }\n\n    clear() {\n        return new Promise((resolve, reject) => {\n            const request = this._connection\n                .transaction([this._store], 'readwrite')\n                .objectStore(this._store)\n                .clear();\n\n            request.onsuccess = e => resolve();\n            request.onerror = e => {\n                console.log(e.target.error);\n                reject('Error deleting the negotiations');\n            }\n        });\n    }\n}"]}